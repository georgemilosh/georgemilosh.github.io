<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="google-site-verification=E4KIsiGdkAKwCvDyL7iYIfmitMwtc7hWhBdUV4jZX5M"> <meta name="msvalidate.01" content=""> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>WHAMP Tutorial for Plasma Wave Dispersion Analysis | George Miloshevich</title> <meta name="author" content="George Miloshevich"> <meta name="description" content="A comprehensive guide to using WHAMP for studying plasma instabilities with Python automation"> <meta name="keywords" content="George Miloshevich, Physicist, Machine Learning, Climate, Scientist"> <meta property="og:site_name" content="George Miloshevich"> <meta property="og:type" content="website"> <meta property="og:title" content="George Miloshevich | WHAMP Tutorial for Plasma Wave Dispersion Analysis"> <meta property="og:url" content="https://georgemilosh.github.io/blog/2025/whamp/"> <meta property="og:description" content="A comprehensive guide to using WHAMP for studying plasma instabilities with Python automation"> <meta property="og:locale" content="en"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="WHAMP Tutorial for Plasma Wave Dispersion Analysis"> <meta name="twitter:description" content="A comprehensive guide to using WHAMP for studying plasma instabilities with Python automation"> <meta name="twitter:site" content="@george_milosh"> <meta name="twitter:creator" content="@george_milosh"> <script type="application/ld+json">
      {
        "author":
        {
          "@type": "Person",
          "name": "George  Miloshevich"
        },
        "url": "https://georgemilosh.github.io/blog/2025/whamp/",
        "@type": "WebSite",
        "description": "A comprehensive guide to using WHAMP for studying plasma instabilities with Python automation",
        "headline": "WHAMP Tutorial for Plasma Wave Dispersion Analysis",
        "sameAs": ["https://orcid.org/https://orcid.org/0000-0001-9896-1704", "https://scholar.google.com/citations?user=QMFVv0AAAAAJ", "https://github.com/georgemilosh", "https://www.linkedin.com/in/george-miloshevich-2b834212a", "https://twitter.com/george_milosh", "https://medium.com/@georgemilosh"],
        "name": "George  Miloshevich",
        "@context": "https://schema.org"
      }
    </script> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://georgemilosh.github.io/blog/2025/whamp/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "WHAMP Tutorial for Plasma Wave Dispersion Analysis",
      "description": "A comprehensive guide to using WHAMP for studying plasma instabilities with Python automation",
      "published": "July 8, 2025",
      "authors": [
        {
          "author": "George Miloshevich",
          "authorURL": "https://georgemilosh.github.io/",
          "affiliations": [
            {
              "name": "CmPA, KU Leuven",
              "url": ""
            }
          ]
        },
        {
          "author": "WHAMP Developers",
          "authorURL": "https://github.com/irfu/whamp",
          "affiliations": [
            {
              "name": "Space Physics Community",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">George </span>Miloshevich</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">talks</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">more</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/repositories/">repositories</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/teaching/">teaching</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>WHAMP Tutorial for Plasma Wave Dispersion Analysis</h1> <p>A comprehensive guide to using WHAMP for studying plasma instabilities with Python automation</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#introduction-to-whamp">Introduction to WHAMP</a></div> <div><a href="#setting-up-the-environment">Setting Up the Environment</a></div> <div><a href="#python-wrapper-implementation">Python Wrapper Implementation</a></div> <div><a href="#parameter-sweep-analysis">Parameter Sweep Analysis</a></div> <div><a href="#data-analysis-and-visualization">Data Analysis and Visualization</a></div> <div><a href="#advanced-features">Advanced Features</a></div> </nav> </d-contents> <p><strong>NOTE:</strong> Guide for using python wrapper for WHAMP (Waves in Homogeneous Anisotropic Magnetized Plasma). The example that is considered is parallel firehose instability.</p> <h2 id="introduction-to-whamp">Introduction to WHAMP</h2> <p>WHAMP is a Fortran code originally written by Kjell Rönnmark that calculates general wave dispersion relations in plasmas <d-cite key="ronnmark1982whamp"></d-cite>. The code solves the linearized Vlasov-Maxwell system for a homogeneous, anisotropic, multi-component plasma in a uniform magnetic field.</p> <div class="d-flex justify-content-center"> <div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/brazil-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/brazil-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/brazil-1400.webp"></source> <img src="/assets/img/brazil.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Part of the ``Brazil plot'' obtained by running WHAMP over a range of plasma parameters $\beta$ and temperature anisotropy $A$. The plot shows the growth rate of the parallel firehose instability as a function of these parameters. </div> <p>The key physics behind WHAMP involves solving the dispersion relation:</p> \[\det(\mathbf{K}) = 0\] <p>where $\mathbf{K}$ is the wave operator matrix that depends on the plasma parameters, wave frequency $\omega$, and wave vector $\mathbf{k}$. For each set of plasma conditions, WHAMP finds the complex frequency $\omega = \omega_r + i\omega_i$ where:</p> <ul> <li>$\omega_r$ is the real frequency (wave propagation)</li> <li>$\omega_i$ is the imaginary frequency (growth/damping rate)</li> </ul> <p>The <strong>parallel firehose instability</strong> occurs when $T_\perp &lt; T_\parallel$ (temperature anisotropy $A = T_\perp/T_\parallel &lt; 1$) and manifests as unstable modes with $\omega_i &gt; 0$ propagating parallel to the magnetic field.</p> <p>A good source for understanding parallel firehose instaiblity is the book <d-cite key="gary1993microinstabilities"></d-cite></p> <h2 id="setting-up-the-environment">Setting Up the Environment</h2> <p>Clone the wrapper fork of the original WHAMP repository and navigate to the <code class="language-plaintext highlighter-rouge">src</code> directory:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:georgemilosh/whamp.git
<span class="nb">cd </span>src
</code></pre></div></div> <p>Ensure you have the required dependencies and WHAMP compiled:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Build WHAMP</span>
make clean <span class="o">&amp;&amp;</span> make
</code></pre></div></div> <p>We have made some small modification to the original WHAMP code to allow more flexibility in input parameters and integration with the wrapper</p> <p>The project structure should look like:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>whamp/
├── src/
│   ├── whamp_wrapper.py      # Python wrapper
│   └── whamp                 # Compiled executable
├── Models/
│   └── H17f3c               # Example plasma model
├── results/
│   └── (output files)
└── examples/
    └── parallel_firehose_sweep.ipynb
</code></pre></div></div> <h3 id="setting-up-the-plasma-model">Setting up the plasma model</h3> <p>To set the physical model for WHAMP, you need to create a text file with the plasma parameters. The format is as follows:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c"># Model from Fig 5 of Hunana, P.; Zank, G. P. On the Parallel and Oblique Firehose Instability in Fluid Models. ApJ 2017, 839 (1), 13. https://doi.org/10.3847/1538-4357/aa64e3.</span>
<span class="c"># Density values (m^-3) for 10 species</span>
1.0e6 1.0e6 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
<span class="c"># Temperature values (eV) for 10 species  </span>
0.005  1e-8 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
<span class="c"># Loss cone parameter D for 10 species</span>
1.    1.   1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 
<span class="c"># Temperature anisotropy A for 10 species</span>
0.49    1.   1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 
<span class="c"># Loss cone parameter B for 10 species</span>
0.0   0.0  0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
<span class="c"># Atomic mass for 10 species (0=electron, 1=proton, etc.)</span>
1.0  0.  0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
<span class="c"># Drift velocity for 10 species</span>
0.    .0  0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
<span class="c"># Electron Gyrofrequency (kHz)</span>
0.01986
<span class="c"># PZL parameter</span>
0
<span class="c"># Ion to electron mass ratio</span>
1836.1

</code></pre></div></div> <p>We have added the possibility of having comments and the possibility to control the ion to electron mass ratio which was previously hardcoded to 1836.1. The file should be saved in the <code class="language-plaintext highlighter-rouge">Models/modelname</code></p> <h2 id="python-wrapper-implementation">Python Wrapper Implementation</h2> <p>The <code class="language-plaintext highlighter-rouge">whamp_wrapper.py</code> module provides three main functions for automating WHAMP simulations. Let’s examine the key components:</p> <h3 id="reading-whamp-output">Reading WHAMP Output</h3> <p><code class="language-plaintext highlighter-rouge">read_whamp_output</code> - The most critical function parses WHAMP’s output format. This function reads the WHAMP output text file and parses key parameters such as perpendicular and parallel wavenumbers (<code class="language-plaintext highlighter-rouge">p</code>, <code class="language-plaintext highlighter-rouge">z</code>), real and imaginary parts of the frequency (<code class="language-plaintext highlighter-rouge">omega_r</code>, <code class="language-plaintext highlighter-rouge">omega_i</code>), and electric field components. It uses regular expressions to extract these values from each line and returns a pandas DataFrame for further analysis.</p> <h3 id="parameter-sweep-analysis">Parameter Sweep Analysis</h3> <p>The most powerful feature is automated parameter sweeps. Here’s how to study the parallel firehose instability across different temperature anisotropies and plasma beta values:</p> <p><code class="language-plaintext highlighter-rouge">read_whamp_automated</code> - This code performs an automated parameter sweep for a plasma simulation using the run_whamp_automated function. It:</p> <ul> <li>Defines ranges for temperature anisotropy (a_values) and cyclotron frequency (c_values).</li> <li>Builds a sequence of command strings to set up and run simulations for each parameter combination.</li> <li>Adjusts the wavenumber scan range based on the anisotropy value.</li> <li>Executes the simulation sweep and saves results to a file.</li> </ul> <h3 id="understanding-whamp-commands">Understanding WHAMP Commands</h3> <p>The command syntax follows specific patterns:</p> <table> <thead> <tr> <th>Command</th> <th>Description</th> <th>Example Usage / Notes</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">p0,1,-.1</code></td> <td>Set P range: start=0, end=1, step=-0.1</td> <td>Perpendicular wavenumber (descending)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">z0,2,.1</code></td> <td>Set Z range: start=0, end=2, step=0.1</td> <td>Parallel wavenumber (ascending)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">p0</code></td> <td>Set P fixed value</td> <td>Parallel wavenumber (fixed value)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">f1e-4</code></td> <td>Set frequency guess</td> <td>Initial frequency</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">a2.0</code></td> <td>Set temperature anisotropy A=2.0</td> <td>$T_\perp/T_\parallel$</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">a(2)2.0</code></td> <td>Set anisotropy for second species</td> <td>$T_{\perp,2}/T_{\parallel,2}$</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">c0.1</code></td> <td>Set electron cyclotron frequency c=0.1 kHz</td> <td>Magnetic field strength</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">pzfewa</code></td> <td>Output format: p,z,f,e,w,a</td> <td>Electric fields + wave parameters</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">pzfewa(2)</code></td> <td>Output format: p,z,f,e,w,a(2)</td> <td>Electric fields + wave parameters</td> </tr> </tbody> </table> <p>For parallel firehose the following commands are used:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">a_values</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">logspace</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">log10</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">log10</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># logarithmically spaced between 0.1 and 1.0 inclusive
</span>    <span class="n">c_values</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">logspace</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">log10</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">0.01986</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">log10</span><span class="p">(</span><span class="mf">0.01986</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>  <span class="c1"># logarithmically spaced cyclotron frequency
</span>    <span class="n">f_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">c_values</span><span class="p">))]</span>  <span class="c1"># sweep over frequency
</span>    <span class="n">commands</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">p0z0,1.5,-.1f1e-4</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pzfewa</span><span class="sh">'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">c_values</span><span class="p">,</span> <span class="n">f_values</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">a_values</span><span class="p">:</span>
            <span class="n">commands</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">c</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s">a</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s">f</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
                <span class="n">commands</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">z0,.6,-.05</span><span class="sh">'</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">commands</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">z0,2,-.1</span><span class="sh">'</span><span class="p">)</span>
            <span class="n">commands</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">p0z0,1,-.05</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">commands</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">S</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <p>The intuition is to find a good initial guess for the frequency and initial wavenumber. The code will attempt to stay on the same branch while sweeping through <code class="language-plaintext highlighter-rouge">p</code> and <code class="language-plaintext highlighter-rouge">z</code> wavenumbers. If <code class="language-plaintext highlighter-rouge">c</code> or <code class="language-plaintext highlighter-rouge">a</code> are changed the code starts adjusting from again.</p> <h3 id="data-analysis-and-visualization">Data Analysis and Visualization</h3> <p>Once the parameter sweep completes, we can analyze the results by making sure that the right eigenmodes are selected, corresponding to the parallel firehose instability.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load and clean the data
</span><span class="n">df_raw</span> <span class="o">=</span> <span class="nf">read_whamp_output</span><span class="p">(</span><span class="sh">'</span><span class="s">../results/parameter_sweep.txt</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Filter out spurious high-frequency solutions
</span><span class="n">df</span> <span class="o">=</span> <span class="n">df_raw</span><span class="p">[(</span><span class="n">df_raw</span><span class="p">[</span><span class="sh">'</span><span class="s">omega_r</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">1e3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_raw</span><span class="p">[</span><span class="sh">'</span><span class="s">omega_r</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">1e3</span><span class="p">)]</span>

<span class="c1"># Filter for right-hand circularly polarized modes (parallel firehose)
</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">EX_real</span><span class="sh">'</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">EY_imag</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">EY_real</span><span class="sh">'</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">EY_imag</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Filtered data: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s"> points</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p>To make the figure in the beginning of the post, we can use the scripts found in the <a href="https://github.com/georgemilosh/whamp/blob/master/examples/parallel_firehose_sweep.ipynb" rel="external nofollow noopener" target="_blank">jupyter notebook</a>.</p> <div class="d-flex justify-content-center"> <div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/growth-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/growth-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/growth-1400.webp"></source> <img src="/assets/img/growth.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Curves of growth obtained by running WHAMP over a range of plasma parameters $\beta$ and temperature anisotropy $A$. The plot shows the growth rate of the parallel firehose instability as a function parallel wavenumber. </div> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2025-07-05-whamp.bib"></d-bibliography><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"georgemilosh/georgemilosh.github.io","data-repo-id":"R_kgDOGhoqGg==","data-category":"General","data-category-id":"DIC_kwDOGhoqGs4CTi-m","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 George Miloshevich. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>